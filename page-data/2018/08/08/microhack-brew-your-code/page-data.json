{"componentChunkName":"component---src-templates-blog-post-js","path":"/2018/08/08/microhack-brew-your-code","webpackCompilationHash":"4a86779ccf4d1b44ab75","result":{"data":{"markdownRemark":{"id":"66cb6876-2e21-5001-b872-ec3cfe74c8d5","excerpt":"Working on a Mac made my work a lot more fun. Especially when I was introduced to homebrew, the missing package manager for macOS. MacPorts…","html":"<p>Working on a Mac made my work a lot more fun. Especially when I was introduced to <a href=\"https://brew.sh/\">homebrew</a>, the missing package manager for macOS.</p>\n<p>MacPorts was fine, but it felt clumsy. Every tool seems to be switched to Homebrew and life was good.. Except when you encounter that one tool you need but is not available in brew…</p>\n<h2 id=\"meet-gits\"><a href=\"#meet-gits\" aria-label=\"meet gits permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Meet Gits</h2>\n<p>An example of this is the great shell script made by Roy Lines: <a href=\"https://github.com/roylines/gits\">gits</a>.\nA shell script to share contribution between two git accounts when pair programming.</p>\n<p>Unfortunately you have to install it by getting a remote bash script and add it in your /usr/local/bin directory with root rights.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ sudo wget https://raw.github.com/roylines/gits/master/gits.sh -O /usr/local/bin/gits\n$ sudo chmod ugo+x /usr/local/bin/gits\n$ gits</code></pre></div>\n<p>When I see something like this, it’s another hurdle for using great scripts. It’s a good practice to check these scripts, before putting them into your bash with execution rights. Sometimes, I’m to lazy to do that..\nAlso I always tend to forget these scripts, so they are never updated and never removed. Your system becomes a mess.</p>\n<p>More people did not like that. An <a href=\"https://github.com/roylines/gits/issues/6\">issue</a> was raised with a question whether it could be installed with homebrew..</p>\n<blockquote>\n<p>How can it install it on mac? I would prefer to use homebrew.</p>\n</blockquote>\n<p>Well, let’s help Adam!</p>\n<h2 id=\"create-our-own-tap\"><a href=\"#create-our-own-tap\" aria-label=\"create our own tap permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Create our own tap</h2>\n<h3 id=\"correct-format\"><a href=\"#correct-format\" aria-label=\"correct format permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Correct format</h3>\n<p>First step is to change the structure of your script so it can be used for brew.\nScripts need to be in the <code class=\"language-text\">bin/</code> directory so that is the first thing we need to do.</p>\n<p>Simply moving the script to the <code class=\"language-text\">bin</code> directory..</p>\n<p><a href=\"https://github.com/JeroenKnoops/gits/commit/4de9197fe1e24b751af2a1fe214b4259bf256c49\">https://github.com/JeroenKnoops/gits/commit/4de9197fe1e24b751af2a1fe214b4259bf256c49</a></p>\n<h3 id=\"release-the-script\"><a href=\"#release-the-script\" aria-label=\"release the script permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Release the script</h3>\n<p>You have to create a release of your script. You can do that by <a href=\"https://github.com/JeroenKnoops/gits/releases\">drafting a new release</a></p>\n<p>Once you have a release, we need the SHA-256 checksum of the release to ensure a proper version of the download.\nBrowse to the release and copy the name of the tar-file (in our case: <code class=\"language-text\">https://github.com/JeroenKnoops/gits/archive/0.1.0.tar.gz</code>)</p>\n<p>Download the tar and generate the SHA-256.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ wget https://github.com/JeroenKnoops/gits/archive/0.1.0.tar.gz\n$ shasum -a 256 0.1.0.tar.gz\n13b778bf5a7f92285f54179cd88bea4b39f661a3de47a7ff0a84b9aa5d865962  0.1.0.tar.gz</code></pre></div>\n<p>We will need this SHA-256 for our formula.</p>\n<h3 id=\"define-the-formula\"><a href=\"#define-the-formula\" aria-label=\"define the formula permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Define the Formula</h3>\n<p>We have to define the formula. This can be done by creating a repo called <a href=\"https://github.com/JeroenKnoops/homebrew-tap\">homebrew-tap</a> in your own github repo.\nIt’s best practice to put some information in the README of this repo about the Formulas which are defined.</p>\n<p>In our case:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## homebrew-tap\nHomebrew tap with formula for installing the following:\n\n- [gits](https://github.com/jeroenknoops/gits)\n\n\n#### Add this tap\n`brew tap jeroenknoops/tap`\n\n\n#### Install\n- gits: `brew install gits`</code></pre></div>\n<p>In the <code class=\"language-text\">/Formula</code> directory you must create a ruby file with the definition, in our case: <a href=\"https://github.com/JeroenKnoops/homebrew-tap/blob/master/Formula/gits.rb\">gits.rb</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">class Gits &lt; Formula\n  desc &quot;A shell script to share contribution between two git accounts when pair programming.&quot;\n  homepage &quot;https://github.com/jeroenknoops/gits&quot;\n  url &quot;https://github.com/JeroenKnoops/gits/archive/0.1.0.tar.gz&quot;\n  version &quot;0.1.0&quot;\n  sha256 &quot;13b778bf5a7f92285f54179cd88bea4b39f661a3de47a7ff0a84b9aa5d865962&quot;\n\n  def install\n    bin.install &quot;bin/gits&quot;\n  end\nend</code></pre></div>\n<p>Push the repo to github and we’re ready to go.</p>\n<h3 id=\"test-it\"><a href=\"#test-it\" aria-label=\"test it permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Test it</h3>\n<p>Now people can use the script by installing it with homebrew.\nIt’s still in my private homebrew-tap, so people first have to tap into our private tap.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">brew tap jeroenknoops/tap</code></pre></div>\n<p>After that they can install gits with <code class=\"language-text\">brew install gits</code></p>\n<h2 id=\"i-do-not-want-to-tap-into-someones-tap\"><a href=\"#i-do-not-want-to-tap-into-someones-tap\" aria-label=\"i do not want to tap into someones tap permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>I do not want to tap into someone’s tap</h2>\n<p>To even raise the level of trust of the script / tool and install convenience, you can also put the Formula directly into the <a href=\"https://github.com/Homebrew/homebrew-core\">homebrew-core</a>. Now people don’t need to tap into someones private tap.\nThis will require some extra steps, like adding tests.</p>\n<p>Brew has a way to test your formula by doing: <code class=\"language-text\">brew audit --new-formula gits</code></p>\n<p>This will show you what you still need to do, before you can submit it to homebrew. You can also find more information on that in the <a href=\"https://docs.brew.sh/Formula-Cookbook\">Formula-Cookbook</a></p>\n<h2 id=\"improvements\"><a href=\"#improvements\" aria-label=\"improvements permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Improvements</h2>\n<p>There are more improvements I should make to release it to homebrew. F.e. add dependencies to <code class=\"language-text\">git</code>.\nFor now I’m not going to dive into that. Homebrew has good documentation on that: <a href=\"https://docs.brew.sh/Formula-Cookbook\">https://docs.brew.sh/Formula-Cookbook</a></p>\n<h2 id=\"conclusion\"><a href=\"#conclusion\" aria-label=\"conclusion permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusion</h2>\n<p>I really liked the way homebrew is set up. I like the way they name things, like <code class=\"language-text\">brew</code>, <code class=\"language-text\">tap</code> and <code class=\"language-text\">bottle</code>. By adding my own <code class=\"language-text\">bottle</code> I’ve learned how homebrew is working and now I even feel more confident in using it. I like the fact that only bottles with tests and with the proper dependencies check can be added in the core homebrew formulas.</p>\n<h3 id=\"homebrew-cask\"><a href=\"#homebrew-cask\" aria-label=\"homebrew cask permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Homebrew cask</h3>\n<p>Homebrew has another great feature, called <a href=\"https://github.com/Homebrew/homebrew-cask\">homebrew cask</a>. No more: “To install, drag this icon..“. Now you can install tools like <code class=\"language-text\">atom</code> or <code class=\"language-text\">1password</code> by simply calling: <code class=\"language-text\">brew cask install atom</code>…</p>\n<h2 id=\"more-info\"><a href=\"#more-info\" aria-label=\"more info permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>More info</h2>\n<ul>\n<li><a href=\"https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap\">https://docs.brew.sh/How-to-Create-and-Maintain-a-Tap</a></li>\n<li><a href=\"https://docs.brew.sh/Formula-Cookbook\">https://docs.brew.sh/Formula-Cookbook</a></li>\n<li><a href=\"https://github.com/Homebrew/homebrew-cask\">https://github.com/Homebrew/homebrew-cask</a></li>\n</ul>","frontmatter":{"title":"Microhack Brew your code","subtitle":"How to create a brew package","date":"2018-08-08","slug":"2018/08/08/microhack-brew-your-code","language":null,"tags":["microhack","mac","brew"],"authors":["jeroen"],"comments":null,"cover":{"publicURL":"/static/vanmoll-brew-3c84164187555670cd7a390b08411c63.jpg"},"coverLink":null,"coverDescription":null,"imageTw":{"publicURL":"/static/2018-08-08-microhack-brew-your-code-tw-912f2be18118534e406521c211eef01c.png"},"imageFb":{"publicURL":"/static/2018-08-08-microhack-brew-your-code-fb-c4ebbbdb49da819aec930d1b121a5440.png"},"asciinema":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"2018/08/08/microhack-brew-your-code","previous":{"frontmatter":{"title":"Immutable Infrastructure","slug":"2018/05/26/immutable-infrastructure-taipei","type":"post","tags":["terraform","aws","docker","microservices"],"authors":["niek"]}},"next":{"frontmatter":{"title":"Maze Generation","slug":"2018/08/22/maze-generation","type":"post","tags":["clojure","functional"],"authors":["maarten"]}}}}}